from datetime import datetime
from unittest.mock import patch
from core_lib.utils.date_time_util import (
    get_current_utc_time_millis,
    get_current_utc_datetime_iso,
)


def test_get_current_utc_time_millis():
    with patch("core_lib.utils.date_time_util.time.time") as mock_time:
        mock_time.return_value = 1622246767.123456
        result = get_current_utc_time_millis()
        assert result == 1622246767123


def test_get_current_utc_datetime_iso():
    with patch("core_lib.utils.date_time_util.datetime") as mock_datetime:
        mock_utcnow = datetime(2023, 5, 27, 15, 30, 45)
        milliseconds = 539
        microseconds = milliseconds * 1000
        mock_utcnow_with_micros = mock_utcnow.replace(microsecond=microseconds)
        mock_datetime.utcnow.return_value = mock_utcnow_with_micros
        result = get_current_utc_datetime_iso()
        assert result == mock_utcnow_with_micros.isoformat()
