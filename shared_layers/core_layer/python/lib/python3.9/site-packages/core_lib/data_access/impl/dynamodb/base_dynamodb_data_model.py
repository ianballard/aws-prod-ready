from core_lib.utils.json_schema_util import (
    JSON_SCHEMA_2020_12_DRAFT,
    STRING,
    NULLABLE_UUID_STRING,
    UUID_STRING,
    ISO_DATE_TIME_FORMAT,
    BOOLEAN,
)

BASE_DYNAMODB_DATA_MODEL_SCHEMA = {
    **JSON_SCHEMA_2020_12_DRAFT,
    "title": "BaseDataModel",
    "type": "object",
    "properties": {
        "pk": STRING,
        "sk": STRING,
        "entity_type": STRING,
        "origin_region": STRING,
        "created_by": NULLABLE_UUID_STRING,
        "updated_by": UUID_STRING,
        "created_date_time": ISO_DATE_TIME_FORMAT,
        "updated_date_time": ISO_DATE_TIME_FORMAT,
        "is_deleted": BOOLEAN,
    },
    "required": [
        "pk",
        "sk",
        "entity_type",
        "origin_region",
        "created_date_time",
    ],
    "additionalProperties": False,
}


class DynamoDBItem:
    def __init__(self, new_item_builder, put_item_validator, update_item_validator):
        self.build_new_item = new_item_builder
        self.put_item_validator = put_item_validator
        self.update_item_validator = update_item_validator
