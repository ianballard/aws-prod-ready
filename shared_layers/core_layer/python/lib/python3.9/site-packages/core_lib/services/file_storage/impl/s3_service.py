import boto3

from core_lib.services.parameter.parameter_service import (
    get_parameter_value,
    ParameterName,
)

s3_client = boto3.client("s3")
s3_resource = boto3.resource('s3')
S3_APP_STORAGE_BUCKET = None


def get_app_storage_bucket():
    global S3_APP_STORAGE_BUCKET

    if S3_APP_STORAGE_BUCKET is None:
        S3_APP_STORAGE_BUCKET = get_parameter_value(ParameterName.S3_APP_STORAGE_BUCKET)

    return S3_APP_STORAGE_BUCKET


def upload(key: str, content):
    return s3_resource.Object(bucket_name=get_app_storage_bucket(), key=key).put(Body=content)


def download(key: str):
    return s3_client.get_object(Bucket=get_app_storage_bucket(), Key=key)
