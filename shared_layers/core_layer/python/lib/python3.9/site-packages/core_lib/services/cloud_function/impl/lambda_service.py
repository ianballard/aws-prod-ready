from core_lib.utils.args_util import get_non_null_kwargs
from core_lib.utils.log_util import log_unexpected_exception
import boto3

lambda_client = boto3.client("lambda")


def list_functions(**kwargs):
    return lambda_client.list_functions(**get_non_null_kwargs(**kwargs))


def add_invoke_permission(function_name: str, statement_id: str, principle: str):
    try:
        lambda_client.add_permission(
            FunctionName=function_name,
            StatementId=statement_id,
            Action="lambda:InvokeFunction",
            Principal=principle,
        )
    except lambda_client.exceptions.ResourceConflictException as e:
        pass
    except Exception as e:
        log_unexpected_exception(e)
