import boto3
from core_lib.services.parameter.parameter_service import get_parameter_value, ParameterName
from boto3.dynamodb.types import TypeDeserializer

dynamodb_resource = boto3.resource("dynamodb")
dynamodb_client = boto3.client('dynamodb')

DB_TABLE = None


def get_db_table():
    global DB_TABLE

    if DB_TABLE is None:
        DB_TABLE = get_parameter_value(ParameterName.DB_TABLE)

    return DB_TABLE


def dynamodb_json_to_json(dynamodb_json):
    deserializer = TypeDeserializer()
    normal_json = {
        key: deserializer.deserialize(record)
        for key, record in dynamodb_json.items()
    }
    return normal_json




def put_object(object):
    pass

def update_object(object):
    pass

def get_object(object):
    pass

def query(object):
    pass

def delete(object):
    pass